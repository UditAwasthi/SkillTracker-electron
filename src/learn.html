<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Learning Lab | SkillTracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;900&family=Fira+Code:wght@400;500&display=swap');
        body { font-family: 'Inter', sans-serif; background: #000; color: #fff; }
        .code-font { font-family: 'Fira Code', monospace; }
        .glass { background: rgba(255,255,255,0.03); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.05); }
        .sidebar { width: 320px; border-right: 1px solid rgba(255,255,255,0.05); }
        .active-topic { background: white; color: black; border-radius: 12px; }
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="flex h-screen overflow-hidden" x-data="{
    course: JSON.parse(localStorage.getItem('activeCourse') || '{}'),
    activeChapterIdx: 0,
    activeTopicIdx: 0,

    get currentTopic() {
        return this.course.chapters[this.activeChapterIdx].topics[this.activeTopicIdx];
    },

    next() {
        let currentChapter = this.course.chapters[this.activeChapterIdx];
        if (this.activeTopicIdx < currentChapter.topics.length - 1) {
            this.activeTopicIdx++;
        } else if (this.activeChapterIdx < this.course.chapters.length - 1) {
            this.activeChapterIdx++;
            this.activeTopicIdx = 0;
        }
    }
}">

    <aside class="sidebar flex flex-col p-6 overflow-y-auto">
        <div class="mb-10">
            <a href="dashboard.html" class="text-[10px] font-bold opacity-30 uppercase tracking-[0.3em] hover:opacity-100 transition-all">← Dashboard</a>
            <h2 class="text-lg font-black mt-4 leading-tight" x-text="course.title"></h2>
        </div>

        <div class="space-y-8">
            <template x-for="(chapter, cIdx) in course.chapters" :key="cIdx">
                <div>
                    <h3 class="text-[10px] font-bold text-white/30 uppercase tracking-widest mb-4" x-text="'Chapter ' + chapter.chapterId"></h3>
                    <div class="space-y-1">
                        <template x-for="(topic, tIdx) in chapter.topics" :key="tIdx">
                            <button 
                                @click="activeChapterIdx = cIdx; activeTopicIdx = tIdx"
                                :class="(activeChapterIdx === cIdx && activeTopicIdx === tIdx) ? 'active-topic' : 'text-white/50 hover:text-white'"
                                class="w-full text-left px-4 py-3 text-xs font-semibold transition-all duration-300 flex items-center justify-between"
                            >
                                <span x-text="topic.title"></span>
                            </button>
                        </template>
                    </div>
                </div>
            </template>
        </div>
    </aside>

    <main class="flex-1 overflow-y-auto relative flex flex-col bg-[#050505]">
        <div class="h-1 bg-white/5 w-full sticky top-0 z-10">
            <div class="h-full bg-white transition-all duration-500" 
                 :style="'width: ' + (((activeChapterIdx + 1) / course.chapters.length) * 100) + '%'"></div>
        </div>

        <article class="max-w-3xl mx-auto py-20 px-8 w-full flex-1">
            <header class="mb-12">
                <p class="text-[10px] font-black text-white/20 uppercase tracking-[0.5em] mb-4" x-text="course.chapters[activeChapterIdx].chapterTitle"></p>
                <h1 class="text-5xl font-black tracking-tighter" x-text="currentTopic.title"></h1>
            </header>

            <div class="space-y-10">
                <template x-for="section in currentTopic.content.sections" :key="section._id">
                    <div>
                        <template x-if="section.type === 'text'">
                            <p class="text-xl text-white/60 leading-relaxed font-light" x-text="section.value"></p>
                        </template>

                        <template x-if="section.type === 'code_example'">
                            <div class="mt-6 rounded-2xl overflow-hidden border border-white/10">
                                <div class="bg-white/5 px-6 py-3 flex justify-between items-center border-b border-white/10">
                                    <span class="text-[10px] font-bold uppercase tracking-widest text-white/30" x-text="section.heading"></span>
                                    <span class="text-[10px] font-mono text-white/20" x-text="section.language"></span>
                                </div>
                                <pre class="p-6 bg-black code-font text-sm text-blue-300 overflow-x-auto"><code x-text="section.code"></code></pre>
                                <a :href="section.tryItUrl" target="_blank" class="block w-full py-4 text-center text-[10px] font-bold bg-white/5 hover:bg-white/10 transition-colors uppercase tracking-widest">Run in Playground ↗</a>
                            </div>
                        </template>
                    </div>
                </template>
            </div>

            <footer class="mt-20 pt-10 border-t border-white/5 flex justify-between items-center">
                <div class="text-[10px] font-bold text-white/20">MODULE COMPLETE?</div>
                <button @click="next()" class="bg-white text-black px-10 py-4 rounded-full font-black text-xs uppercase tracking-widest hover:scale-105 transition-transform">
                    Next Topic →
                </button>
            </footer>
        </article>
    </main>
</body>
</html>