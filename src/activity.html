<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SkillTracker | Neural Activity</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url("https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap");
        body { font-family: "Plus Jakarta Sans", sans-serif; background: #000; color: #fff; letter-spacing: -0.03em; }
        
        .glass { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(40px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .squircle { border-radius: 24px; }
        
        /* HEATMAP STYLES */
        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(53, 1fr);
            gap: 3px;
        }
        .heat-cell {
            aspect-ratio: 1;
            border-radius: 2px;
            background: rgba(255, 255, 255, 0.03);
            transition: all 0.3s ease;
        }
        .heat-1 { background: #312e81; } /* Indigo-900 */
        .heat-2 { background: #4338ca; } /* Indigo-700 */
        .heat-3 { background: #6366f1; } /* Indigo-500 */
        .heat-4 { background: #818cf8; box-shadow: 0 0 10px rgba(99, 102, 241, 0.4); }

        /* CHART STYLES */
        .bar-container { height: 120px; display: flex; align-items: flex-end; gap: 8px; }
        .bar { 
            flex: 1; 
            background: linear-gradient(to top, rgba(99, 102, 241, 0.1), rgba(99, 102, 241, 0.8));
            border-radius: 4px 4px 0 0;
            transition: height 1s cubic-bezier(0.16, 1, 0.3, 1);
        }
    </style>
</head>
<body class="antialiased min-h-screen">

    <nav class="flex justify-between items-center px-10 py-8 relative z-50">
        <div class="flex items-center gap-3">
            <a href="dashboard.html" class="w-5 h-5 bg-white rounded-[5px]"></a>
            <span class="font-bold text-sm tracking-tight uppercase">SkillTracker</span>
        </div>
        <div class="flex gap-8 text-[10px] font-bold text-white/40 uppercase tracking-widest">
            <a href="dashboard.html" class="hover:text-white transition">Vectors</a>
            <a href="activity.html" class="text-white">Activity</a>
            <a href="profile.html" class="hover:text-white transition">Profile</a>
        </div>
    </nav>

    <main class="max-w-6xl mx-auto px-6 py-12">
        <header class="mb-12">
            <h1 class="text-4xl font-extrabold tracking-tighter mb-2">NEURAL_ACTIVITY_LOG</h1>
            <p class="text-white/40 text-[10px] font-bold uppercase tracking-[0.4em]">Real-time engagement matrix</p>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
            <div class="glass squircle p-8 flex justify-between items-center relative overflow-hidden">
                <div>
                    <p class="text-[10px] font-bold text-white/20 uppercase tracking-widest mb-1">Current Streak</p>
                    <h2 id="currentStreak" class="text-4xl font-extrabold italic">0</h2>
                </div>
                <div class="text-indigo-500/20 absolute -right-4 -bottom-4 rotate-12">
                    <svg width="120" height="120" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2c-3.3 0-6 2.7-6 6 0 2.2 1.2 4.1 3 5.2v2.8c0 .6.4 1 1 1h4c.6 0 1-.4 1-1v-2.8c1.8-1.1 3-3 3-5.2 0-3.3-2.7-6-6-6zm2 15h-4v1h4v-1zm0 2h-4v1h4v-1z"/></svg>
                </div>
            </div>
            <div class="glass squircle p-8">
                <p class="text-[10px] font-bold text-white/20 uppercase tracking-widest mb-1">Most Active Day</p>
                <h2 id="activeDay" class="text-2xl font-bold uppercase">---</h2>
            </div>
            <div class="glass squircle p-8">
                <p class="text-[10px] font-bold text-white/20 uppercase tracking-widest mb-1">Monthly Focus</p>
                <h2 id="monthlyFocus" class="text-2xl font-bold uppercase">---</h2>
            </div>
        </div>

        <div class="glass squircle p-8 mb-10">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-[10px] font-bold text-white/40 uppercase tracking-widest">Yearly Contribution Matrix</h3>
                <div class="flex gap-2 items-center text-[10px] text-white/20">
                    <span>Less</span>
                    <div class="w-2 h-2 heat-cell"></div>
                    <div class="w-2 h-2 heat-cell heat-1"></div>
                    <div class="w-2 h-2 heat-cell heat-3"></div>
                    <div class="w-2 h-2 heat-cell heat-4"></div>
                    <span>More</span>
                </div>
            </div>
            <div id="heatmap" class="heatmap-grid"></div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="glass squircle p-8">
                <h3 class="text-[10px] font-bold text-white/40 uppercase tracking-widest mb-8">Weekly Productivity Pulse</h3>
                <div id="weeklyChart" class="bar-container">
                    </div>
                <div class="flex justify-between mt-4 text-[9px] font-bold text-white/20 uppercase tracking-widest">
                    <span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span><span>Sun</span>
                </div>
            </div>
            <div class="glass squircle p-8">
                <h3 class="text-[10px] font-bold text-white/40 uppercase tracking-widest mb-4">Neural Insights</h3>
                <div class="space-y-4">
                    <div class="flex justify-between items-center">
                        <span class="text-sm text-white/40">Knowledge Density</span>
                        <span id="density" class="text-sm font-bold">0%</span>
                    </div>
                    <div class="w-full h-1 bg-white/5 rounded-full">
                        <div id="densityBar" class="h-full bg-indigo-500 rounded-full" style="width: 0%"></div>
                    </div>
                    <p class="text-[11px] text-white/20 leading-relaxed mt-4">
                        <span class="text-indigo-400">AI Note:</span> Your activity spikes on <span id="spikeDay" class="text-white">---</span>. Shift heavy modules to this window for maximum retention.
                    </p>
                </div>
            </div>
        </div>
    </main>

    <script>
        // --- 1. MOCK DATA / LOGIC ---
        // In a real app, you would fetch these from your JWT-protected /activity endpoint
        const activityData = JSON.parse(localStorage.getItem("neuralActivity") || "{}");
        const today = new Date().toISOString().split('T')[0];

        function initActivity() {
            renderHeatmap();
            calculateStreak();
            renderWeeklyPulse();
            updateInsights();
        }

        function renderHeatmap() {
            const grid = document.getElementById("heatmap");
            grid.innerHTML = "";
            // Render 371 cells (53 weeks * 7 days)
            for (let i = 0; i < 371; i++) {
                const cell = document.createElement("div");
                cell.className = "heat-cell";
                // Randomly assign heat for demo; real logic would map dates
                const weight = Math.random();
                if (weight > 0.95) cell.classList.add("heat-4");
                else if (weight > 0.8) cell.classList.add("heat-3");
                else if (weight > 0.6) cell.classList.add("heat-1");
                grid.appendChild(cell);
            }
        }

        function calculateStreak() {
            // Mock logic: looking at localStorage history
            const courses = JSON.parse(localStorage.getItem("allCourses") || "[]");
            const streak = courses.length > 0 ? Math.floor(Math.random() * 5) + 1 : 0; 
            document.getElementById("currentStreak").innerText = streak;
        }

        function renderWeeklyPulse() {
            const chart = document.getElementById("weeklyChart");
            const days = [40, 70, 45, 90, 65, 30, 20]; // Mock activity levels
            chart.innerHTML = days.map(val => `
                <div class="bar" style="height: ${val}%"></div>
            `).join("");
            
            const maxVal = Math.max(...days);
            const dayNames = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
            const bestDay = dayNames[days.indexOf(maxVal)];
            
            document.getElementById("activeDay").innerText = bestDay;
            document.getElementById("spikeDay").innerText = bestDay;
        }

        function updateInsights() {
            const courses = JSON.parse(localStorage.getItem("allCourses") || "[]");
            const density = Math.min(courses.length * 12, 100);
            document.getElementById("density").innerText = density + "%";
            document.getElementById("densityBar").style.width = density + "%";
            
            const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            document.getElementById("monthlyFocus").innerText = monthNames[new Date().getMonth()];
        }

        initActivity();
    </script>
</body>
</html>